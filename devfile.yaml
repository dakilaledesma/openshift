schemaVersion: 2.2.0
metadata:
  name: python-nodejs-workspace
  version: 1.0.0

components:
  - name: python-dev
    container:
      image: registry.access.redhat.com/ubi8/python-39:latest
      memoryLimit: 4Gi
      mountSources: true
      endpoints:
        - name: http-app
          targetPort: 8080
          exposure: public
      env:
        - name: PYTHONPATH
          value: ${PROJECT_SOURCE}

  - name: nodejs-dev
    container:
      image: registry.access.redhat.com/ubi8/nodejs-16:latest
      memoryLimit: 512Mi
      mountSources: true
      endpoints:
        - name: nodejs
          targetPort: 3000
          exposure: public

commands:
  - id: pip-install
    exec:
      component: python-dev
      commandLine: pip install --user -r requirements.txt
      workingDir: ${PROJECT_SOURCE}
      
  - id: npm-install
    exec:
      component: nodejs-dev
      commandLine: npm install
      workingDir: ${PROJECT_SOURCE}
